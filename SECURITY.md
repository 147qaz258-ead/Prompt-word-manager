# 🔒 PromptMaster 安全配置指南

## 重要安全提醒

**警告：切勿在代码中硬编码敏感信息！**

在之前的版本中，飞书应用的凭据（App ID、App Secret等）被直接写在了代码中，这是严重的安全隐患。任何人都可以通过查看源代码获取这些凭据，进而访问你的飞书应用和数据。

## 安全最佳实践

### 1. 凭据管理
- ✅ **安全做法**：让用户在浏览器扩展的设置页面中输入自己的凭据
- ❌ **危险做法**：将凭据硬编码在JavaScript代码中
- ✅ **安全做法**：凭据仅存储在用户的浏览器本地存储中
- ❌ **危险做法**：将凭据上传到服务器或第三方服务

### 2. 浏览器扩展安全
- ✅ 使用Chrome的`storage.sync`或`storage.local`API存储配置
- ✅ 敏感信息只在扩展内部使用
- ❌ 不要通过`console.log`输出敏感信息
- ❌ 不要在URL参数中传递敏感信息

### 3. 飞书应用安全
- ✅ 定期更换App Secret
- ✅ 为应用设置适当的权限范围
- ✅ 监控应用的使用情况
- ❌ 不要分享App Secret给任何人

## 当前实现的安全措施

### 1. 移除硬编码凭据
```javascript
// ❌ 之前的危险做法
this.config = {
  appId: 'cli_a84466381e74100b',
  appSecret: 'ocqzZ4FLobQd5piurZLkbg3T5R2k05R2',
  // ...
};

// ✅ 现在的安全做法
this.config = {
  appId: '', // 用户在设置页面配置
  appSecret: '', // 用户在设置页面配置
  // ...
};
```

### 2. 本地存储
用户配置的飞书凭据只存储在：
- Chrome扩展的`storage.sync`中
- 仅在用户自己的浏览器中可用
- 不会上传到任何服务器

### 3. 配置验证
所有配置操作都会验证：
- App ID格式是否正确（以`cli_`开头）
- App Secret是否为空
- 表格ID格式是否正确（以`tbl`开头）

## 用户配置步骤

### 福利模式用户
1. 创建自己的飞书应用
2. 在扩展设置页面配置自己的应用凭据
3. 使用精选提示词库

### 自定义模式用户
1. 创建自己的飞书应用
2. 准备自己的多维表格数据
3. 在扩展设置页面配置应用凭据
4. 使用个人专属提示词库

## 安全建议

### 对用户
1. **定期更换App Secret**：建议每3-6个月更换一次
2. **监控应用使用**：定期查看飞书开放平台的使用统计
3. **权限最小化**：只为应用添加必要的权限
4. **不要分享凭据**：不要将App Secret分享给他人

### 对开发者
1. **代码审查**：确保没有硬编码的敏感信息
2. **环境变量**：对于后端服务，使用环境变量管理配置
3. **加密存储**：对于需要持久化的敏感信息，考虑加密存储
4. **访问控制**：实施适当的访问控制和权限管理

## 紧急处理

如果怀疑凭据已经泄露，请立即：

1. **更换App Secret**：
   - 登录飞书开放平台
   - 进入应用管理
   - 重新生成App Secret

2. **检查应用日志**：
   - 查看是否有异常访问
   - 确认数据是否安全

3. **更新扩展配置**：
   - 在浏览器扩展中更新新的App Secret
   - 重新测试连接

## 联系方式

如果发现安全问题或有疑问，请：
1. 通过GitHub Issues报告
2. 私密方式联系开发者
3. 不要在公开场合讨论具体的安全问题

---

**记住：安全是持续的过程，不是一次性的任务。保持警惕，定期检查安全措施。**